@{
    ViewData["Title"] = "Hobby Page";
}

<h2>è¶£å‘³ãƒšãƒ¼ã‚¸</h2>

<div id="password-section">
    <p>ã“ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
    <input type="password" id="passwordInput" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
    <button onclick="checkPassword()">é€ä¿¡</button>
    <p id="errorMsg" style="color:red;"></p>
</div>

<div id="animal-section" style="display:none;">
    <h3>ğŸ¾ ãƒ©ãƒ³ãƒ€ãƒ ã‚¢ãƒ‹ãƒãƒ«ç”»åƒã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼</h3>
    <p>ã‚­ãƒ„ãƒã€æŸ´çŠ¬ã€çŒ«ã€ãƒ¬ãƒƒã‚µãƒ¼ãƒ‘ãƒ³ãƒ€ã®ç”»åƒãŒ3ç§’ã”ã¨ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚</p>
    <div style="margin-top:20px;">
        <img id="animalImage" src="" alt="å‹•ç‰©ç”»åƒ">
    </div>
</div>

<style>
    #animalImage {
        width: 100%;
        height: auto;
        max-width: 800px;
        display: block;
        margin: 0 auto;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
</style>

@section Scripts {
    <script>
        const correctPassword = "1234";
        let intervalId;

        function checkPassword() {
            const input = document.getElementById("passwordInput").value;
            if (input === correctPassword) {
                document.getElementById("password-section").style.display = "none";
                document.getElementById("animal-section").style.display = "block";
                startImageRotation();
            } else {
                document.getElementById("errorMsg").innerText = "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™ã€‚";
            }
        }

        // APIå–å¾—é–¢æ•°ãŸã¡
        function fetchFox() {
            return fetch('https://randomfox.ca/floof/')
                .then(res => res.json())
                .then(data => data.image);
        }

        function fetchShiba() {
            return fetch('https://shibe.online/api/shibes?count=1')
			        .then(res => res.json())
			        .then(data => data[0].replace('http://', 'https://')); // HTTPSã«å¤‰æ›
				}

        function fetchCat() {
            return fetch('https://api.thecatapi.com/v1/images/search')
                .then(res => res.json())
                .then(data => data[0].url);
        }

        function fetchRedPanda() {
            return fetch('https://some-random-api.com/animal/red_panda')
                .then(res => res.json())
                .then(data => data.image);
        }

        function startImageRotation() {
            const fetchers = [fetchFox, fetchCat, fetchRedPanda];
            let current = 0;

            function updateImage() {
                fetchers[current % fetchers.length]()
                    .then(url => {
                        document.getElementById("animalImage").src = url;
                    })
                    .catch(err => {
                        console.error("ç”»åƒå–å¾—ã‚¨ãƒ©ãƒ¼:", err);
                    });
                current++;
            }

            updateImage(); // æœ€åˆã®è¡¨ç¤º
            intervalId = setInterval(updateImage, 3000); // 3ç§’ã”ã¨ã«æ›´æ–°
        }
    </script>
}