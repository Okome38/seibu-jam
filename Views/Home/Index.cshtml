@model List<seibuDatabase.Models.Message>
@{
    ViewData["Title"] = "青武jam";
}

<div class="text-center">
    <h1 class="display-4">青武jam</h1>
    <p>福井高専行事予定 <a href="https://www.fukui-nct.ac.jp/wp/wp-content/uploads/2025/04/2faa9754d9a33485215a756bb4c73525-1.pdf">ここから見る</a></p>
</div>

<!-- 天気予報セクション -->
<div class="weather-section">
    <h2>天気予報</h2>
    <div id="weatherForecast" class="weather-forecast">
        <div class="weather-item">
            <div class="date">読み込み中...</div>
            <img class="weather-img" alt="天気アイコン">
            <div class="weather-telop">--</div>
            <div><span class="temp-min">-℃</span>/<span class="temp-max">-℃</span></div>
        </div>
    </div>
    <div id="location">
        <a href="https://www.jma.go.jp/bosai/forecast/" target="_blank">気象庁のデータを元に作成</a>
    </div>
    <div id="currentWeatherText"></div>
</div>

<!-- 混雑度グラフセクション -->
<div class="congestion-section">
    <h2>寮の風呂 混雑度（予測）</h2>
    <canvas id="congestionChart" width="400" height="200"></canvas>
</div>

<!-- 掲示板セクション -->
<div class="bulletin-section">
    <h1>掲示板</h1>

    <!-- 投稿フォーム -->
    <form asp-controller="Firebase" asp-action="PostMessage" method="post">
        <div class="form-group">
            <label>名前:</label>
            <input type="text" name="name" class="form-control" required />
        </div>
        <div class="form-group">
            <label>メッセージ:</label>
            <textarea name="message" class="form-control" rows="4" required></textarea>
        </div>
        <div class="form-group">
            <button type="submit" class="btn btn-primary">投稿</button>
        </div>
    </form>

    <hr />

    <!-- メッセージ一覧表示 -->
    <h2>投稿一覧</h2>
    @if (Model != null && Model.Count > 0)
    {
        <ul class="list-unstyled">
            @foreach (var msg in Model.OrderByDescending(m => m.timestamp))
            {
                <li class="post-item">
                    <strong>@msg.name</strong>（@msg.timestamp.ToLocalTime().ToString("yyyy/MM/dd HH:mm")）:<br />
                    @msg.message
                </li>
            }
        </ul>
    }
    else
    {
        <p>投稿がまだありません。</p>
    }
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
